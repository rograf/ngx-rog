<rog-search #search></rog-search>

<table class="r-table">
  <thead>
    <tr>
      <th scope="col" *ngFor="let header of headers">
        <button
          *ngIf="header.sorting; else noSortingHeader"
          class="r-table__header"
          [ngClass]="getColumnClass(header.key)"
          (click)="setSorting(header.key)"
        >
          {{ header.displayName }}
        </button>
        <ng-template #noSortingHeader>
          <div class="r-table__header">
            {{ header.displayName }}
          </div>
        </ng-template>
      </th>
      <th *ngIf="tableActionsTemplate"></th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let row of rows | rogFilter: search.queryDebounce | rogSortBy: sortedColumn | slice: paginator.startIndex:paginator.endIndex">
      <td *ngFor="let header of headers">
        <ng-template #defaultRow>
          <ng-container [ngSwitch]="header.type">
            <ng-container *ngSwitchCase="">
              {{ getDescendantProp(row, header.key) }}
            </ng-container>
            <ng-container *ngSwitchCase="'date'">
              {{ getDescendantProp(row, header.key) | date: "short" }}
            </ng-container>
            <ng-container *ngSwitchDefault>
              {{ getDescendantProp(row, header.key) }}
            </ng-container>
          </ng-container>
        </ng-template>

        <ng-container
          *ngTemplateOutlet="
            customTemplate[header.key]
              ? customTemplate[header.key]
              : defaultRow;
            context: {
              value: getDescendantProp(row, header.key),
              header: header,
              row: row
            }
          "
        >
        </ng-container>
      </td>
      <td *ngIf="tableActionsTemplate">
        <div>
          <ng-container
            *ngTemplateOutlet="tableActionsTemplate; context: { row: row }"
          ></ng-container>
        </div>
      </td>
    </tr>
  </tbody>
</table>

<rog-paginator #paginator [length]="options.length || rows.length" [pageSize]="options.pageSize" (page)="onChangePage($event)"></rog-paginator>
